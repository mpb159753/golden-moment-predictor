# 10. 前端展示 — 设计需求文档

> **目标:** 为 GMP 预测引擎构建一个可静态托管的前端展示页面，让旅行者查看川西各观景台的景观预测，同时满足运营截图发布小红书的需求。

## 10.1 并行开发方案
为探索最佳的用户体验，我们将并行开发三版采用不同布局逻辑的前端方案。**三版方案均采用相同的技术栈（Vue 3 + 高德地图 JS API）和数据源**，核心区别在于**信息密度**与**交互重心**。

| 方案 | 名称 | 核心逻辑 | 典型参照 | 适用场景 |
|---|---|---|---|---|
| **A** | **沉浸地图 (Map First)** | 地图即一切，地理位置驱动 | Google Maps / 高德 | 探索感强，适合熟悉地理方位的用户 |
| **B** | **分屏浏览 (List Only)** | 列表优先，半屏地图辅助 | Airbnb / 携程酒店 | 浏览效率高，适合快速对比多个点位 |
| **C** | **卡片流 (Card Flow)** | 沉浸式阅读，大图/大卡片 | 天气 App / Instagram | 视觉冲击力强，适合“种草”和截图分享 |

## 10.2 方案 A: 沉浸地图 (Immersive Map)

**布局设计:**
- **底层:** 全屏高德地图，无任何遮挡。
- **顶层:** 
  - 顶部搜索/筛选栏（透明背景，悬浮）。
  - 底部 **Bottom Sheet** (可变高度面板)。初始状态展示“当前位置/精选推荐”的摘要，高度约 20%。
- **Marker:** 地图上展示带评分颜色的 Marker（如：牛背山 98分 🔴）。

**交互逻辑:**
1. **默认状态:** 地图展示所有点位 Marker。Bottom Sheet 显示“今天最佳推荐”。
2. **点击 Marker:** 地图中心移动至该点。Bottom Sheet 自动弹出至 40% 高度，显示该点的**当日预测概览**（评分 + 核心事件图标）。
3. **点击 Bottom Sheet:** 面板展开至 100% 高度（或跳转详情页），展示该点未来 7 天详细预测。
4. **拖拽地图:** Bottom Sheet 缩回至初始状态。

**优点:** 直观，地理位置感强。

## 10.3 方案 B: 分屏浏览 (Split List)

**布局设计:**
- **顶部 (35%):** 固定高度的地图区域。显示当前列表项对应的地理位置。
- **底部 (65%):** 垂直滚动的**预测卡片列表**。每个卡片是一个观景台的当日预测摘要。
- **分割线:** 可选的拖拽条，允许用户调整地图/列表比例。

**交互逻辑:**
1. **列表驱动:** 用户主要在底部列表滑动浏览不同观景台的预测。
2. **联动:** 当列表滚动到“牛背山”卡片时，顶部地图自动 PanTo 到牛背山坐标，并高亮对应 Marker。
3. **点击卡片:** 列表项展开（手风琴效果）或跳转详情页，查看未来详情。
4. **点击地图:** 点击地图上的 Marker，列表自动滚动锚点到对应的卡片位置。

**优点:** 信息获取效率最高，不用频繁切换页面即可对比多地评分。

## 10.4 方案 C: 卡片流 (Card Flow)

**布局设计:**
- **背景:** 全屏地图，但在上层覆盖高斯模糊或暗色遮罩，作为**动态壁纸**存在。
- **前景:** 屏幕中央巨大的**预测卡片**（Swiper 容器），类似“探探”或天气卡片。
- **内容:** 卡片内展示极高精度的视觉信息（大评分数字、动态天气图标、精美插画）。

**交互逻辑:**
1. **滑动驱动:** 用户左右滑动屏幕切换不同的观景台（或同一观景台的不同日期）。
2. **背景联动:** 当卡片从“牛背山”滑向“折多山”时，背景地图平滑飞行过渡到新坐标。
3. **沉浸体验:** 强调视觉冲击力，文字信息精简，点击卡片翻转或弹窗查看详细数据表格。

**优点:** 极具设计感和现代感，非常适合截图分享（卡片本身就是完美的分享图）。

## 10.5 共同功能规格
无论采用何种布局，以下功能在三版中均保持一致：

1. **JSON 数据加载:** 复用 `public/data/index.json` 和 `viewpoints/{id}/forecast.json`。
2. **评分可视化:** 使用统一的组件（ColorRing 或 ProgressBar）展示 0-100 评分。
3. **图标系统:** 统一的 SVG 图标集（云海、金山、星空等）。
4. **详情页内容:** 七日趋势图、每日时段详情表。 (在方案 A/B/C 中作为详情页复用)


## 10.2 设计约束

| 约束 | 说明 |
|------|------|
| **静态托管** | 使用 Cloudflare Pages，前端为纯静态文件，数据由后端 `generate-all` 预生成为 JSON |
| **手机端为主** | Mobile-first 设计，竖屏布局优先 |
| **截图友好** | 每个视图模块（地图总览/预测卡片/多日概览）需独立可截图、视觉精美 |
| **可扩展** | 当前 2 个观景台 + 1 条线路，后续会持续添加新点位 |

## 10.3 技术选型

| 技术 | 选择 | 理由 |
|------|------|------|
| **框架** | Vite + Vue 3 | 组件化开发、动画支持好、CF Pages 原生支持 |
| **地图** | 高德地图 JS API | 中文标注友好，国内用户体验好 |
| **托管** | Cloudflare Pages | `npm run build` 生成静态文件直接部署 |
| **数据** | 静态 JSON (按需加载) | 由 `generate-all` 命令一次性生成所有 JSON 文件 |

## 10.4 视觉风格

**明亮清新 + 插画风**，类似墨迹天气/彩云天气的视觉方向：

- 浅色系为主，白色/浅蓝/浅橙作为基调
- 各景观类型配以小插画图标（山峰 🏔️、云海 ☁️、星空 ⭐、雪花 ❄️）
- 评分用彩色进度条/环形图可视化
- 卡片式布局，圆角 + 柔和阴影 + 渐变背景
- 微动画增强交互体验

## 10.5 截图需求 (小红书运营)

运营每日需截取以下素材发小红书帖子（一帖多图）：

| 截图类型 | 内容 | 用途 |
|---------|------|------|
| **地图总览** | 地图上所有观景台标记 + 当日最佳评分 | 帖子首图，一眼看全局 |
| **单日预测卡片** | 某观景台某日的详细预测，各事件评分 | 帖子详情图 |
| **多日概览** | 某观景台未来 7 天的预测汇总（热力矩阵） | 帖子规划参考图 |

**导出功能:** 提供"手绘风格导出"选项，在导出截图时将地图底图替换为手绘/艺术风格，增强小红书传播效果。

## 10.6 地图需求

| 需求 | 说明 |
|------|------|
| **底图** | 高德地图标准图层 |
| **缩放** | 支持缩放、拖拽浏览 |
| **标记点** | 各观景台以 marker 标注在地图上 |
| **标记样式** | marker 颜色/大小反映当日最佳事件评分 |
| **线路** | 线路以连线展示各站点间关系 |
| **交互** | 点击 marker 查看该观景台预测详情 |
| **无需导航** | 不需要路线规划/导航功能 |
| **可扩展** | 新增观景台只需更新 JSON 数据 |

## 10.7 数据流

```
[后端] generate-all 命令
   │
   ├── public/data/index.json          ← 观景台/线路索引 (含坐标)
   ├── public/data/meta.json           ← 生成时间戳
   ├── public/data/viewpoints/{id}/
   │       ├── forecast.json           ← 多日预测
   │       └── timeline_YYYY-MM-DD.json ← 逐时数据
   └── public/data/routes/{id}/
           └── forecast.json           ← 线路聚合预测
           
[前端] Vue 3 SPA
   │
   ├── 启动时加载 index.json + meta.json
   ├── 地图渲染所有观景台 marker
   └── 按需加载各站点 forecast.json / timeline.json
```

**部署流程:**

1. 定时运行 `python -m gmp.main generate-all` 生成 JSON 到 `public/data/`
2. 前端项目 `npm run build` 产出静态文件
3. 将 `dist/` + `public/data/` 推送至 Cloudflare Pages

## 10.8 待继续探索的设计问题

以下问题未在本次头脑风暴中深入讨论，留待后续会话继续：

- [ ] 详细页面布局方案（地图区域高度、卡片排列方式、日期选择器交互）
- [ ] 评分可视化组件设计（进度条 vs 环形图 vs 热力色块）
- [ ] 多日概览的展示形式（热力矩阵 vs 日历视图 vs 折线图）
- [ ] 线路页面的交互设计（如何展示沿途各站的联合预测）
- [ ] 手绘风格导出的具体实现方案
- [ ] 组合推荐的前端计算逻辑（combo_day / photographer_pick 等标签）
- [ ] 配色方案 & 插画图标资源
- [ ] 高德地图 API Key 管理（开发/生产环境）
- [ ] SEO 和分享 meta 标签（微信/小红书分享卡片）
- [ ] 离线/弱网体验（Service Worker 缓存策略）

---

*文档版本: v0.1 | 最后更新: 2026-02-17 | 状态: 头脑风暴阶段*
